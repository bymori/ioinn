---
title: Redux基本使用
date: 2021-12-15 21:53:41
permalink: /pages/bfca3f/
categories:
  - react
  - React状态管理
tags:
  - 
---
## Redux的安装和依赖

安装Redux

```shell
# NPM
npm install redux

# Yarn
yarn add redux
```

<!-- more -->

## Redux的使用过程

1. 创建一个对象，作为我们要保存的状态
2. 创建Store来存储这个state
   1. 创建store时**必须创建reducer**
   2. 我们可以通过 `store.getState` 来获取当前的state
3. 通过action来修改state
   1. 通过dispatch来派发action
   2. 通常action中都会有type属性，也可以携带其他的数据
4. 修改reducer中的处理代码
   1. reducer是一个纯函数，不需要直接修改state
   2. 后面会讲到直接修改state带来的问题
5. 可以在派发action之前，监听store的变化

```js
// 1.导入redux(不能通过ES6的方式)
// import / export 13.2.0开始支持

// commonjs一种实现 -> nodejs
const redux = require('redux');

// 定义 type 常量
const INCREMENT = 'INCREMENT';
const DECREMENT = 'DECREMENT';
const ADD_NUMBER = 'ADD_NUMBER';
const SUB_NUMBER = 'SUB_NUMBER';

const initialState = {
  counter: 0,
};

// reducer
function reducer(state = initialState, action) {
  switch (action.type) {
    case INCREMENT:
      return { ...state, counter: state.counter + 1 };
    case DECREMENT:
      return { ...state, counter: state.counter - 1 };
    case ADD_NUMBER:
      return { ...state, counter: state.counter + action.num };
    case SUB_NUMBER:
      return { ...state, counter: state.counter - action.num };

    default:
      return state;
  }
}

// store(创建的时候需要传入一个reducer)
const store = redux.createStore(reducer);

// 订阅store的修改
store.subscribe(() => {
  console.log('counter:', store.getState().counter);
});

// actions
const action1 = { type: INCREMENT };
const action2 = { type: DECREMENT };

const action3 = { type: ADD_NUMBER, num: 5 };
const action4 = { type: SUB_NUMBER, num: 12 };

// 派发action
store.dispatch(action1);
store.dispatch(action2);
store.dispatch(action2);
store.dispatch(action3);
store.dispatch(action4);
```
