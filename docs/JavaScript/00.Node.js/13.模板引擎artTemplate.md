---
title: 模板引擎artTemplate
date: 2021-11-06 20:51:39
permalink: /pages/7e04ce/
categories:
  - JavaScript
  - js
tags:
  - 
---
## 模板引擎的基础概念

### 模板引擎

模板引擎是第三方模块。

让开发者以更加友好的方式拼接字符串，使项目代码更加清晰、更加易于维护。

```js
// 未使用模板引擎的写法
 var ary = [{ name: '张三', age: 20 }];
 var str = '<ul>';
 for (var i = 0; i < ary.length; i++) { 
    str += '<li>\
        <span>'+ ary[i].name +'</span>\
        <span>'+ ary[i].age +'</span>\
    </li>';
 }
 str += '</ul>'; 
```

<!-- more -->

```html
 <!-- 使用模板引擎的写法 --> 
 <ul>
    {{each ary}}
        <li>{{$value.name}}</li>
        <li>{{$value.age}}</li>
    {{/each}}
 </ul>
```

### art-template模板引擎

1. 在命令行工具中使用 `npm install art-template` 命令进行下载
2. 使用`const template = require('art-template')`引入模板引擎
3. 告诉模板引擎要拼接的数据和模板在哪 `const html = template(‘模板路径’, 数据);`
4. 使用模板语法告诉模板引擎，模板与数据应该如何进行拼接

#### art-template代码示例

```js
// 引入模板引擎
const template = require('art-template');
const path = require('path');

const views = path.join(__dirname, 'views', '01.art');

/**
 * template(filename, content) 根据模板名渲染模板。
 *  参数：
 *      {string} filename
 *      {Object,string} content
 *  返回值：
 *      如果 content 为 Object，则渲染模板并返回 string
 *      如果 content 为 string，则编译模板并返回 function
 */
const html = template(views, {
  name: '张三',
  age: 20,
});
console.log(html);
```

```html
 <div>
    <span>{{data.name}}</span>
    <span>{{data.age}}</span>
 </div>
```

## 模板引擎语法

### 模板语法

- art-template同时支持两种模板语法：`标准语法`和`原始语法`。
- 标准语法可以让模板更容易读写，原始语法具有强大的逻辑处理能力。

```html
标准语法： {{ 数据 }}
原始语法：<%= 数据  %>
```

#### 输出

将某项数据输出在模板中，标准语法和原始语法如下：

```html
标准语法： {{ 数据 }}
原始语法：<%= 数据  %>
```

```html
<!-- 标准语法 -->
 <p>{{ name }}</p>
 <p>{{ 1 + 1 }}</p>
 <p>{{ 1 + 1 == 2 ? '相等' : '不相等' }}</p>
 <p>{{ content }}</p>
 <p>{{@ content }}</p>
 <!-- 原始语法 -->
 <p><%= name %></p>
 <p><%= 1 + 2%></p>
 <p><%= 1 + 1 == 2 ? '相等' : '不相等' %></p>
 <p><%= content%></p>
 <p><%- content%></p>
```

#### 原文输出

如果数据中携带HTML标签，默认模板引擎不会解析标签，会将其转义后输出。

```html
标准语法： {{@ 数据 }}
原始语法：<%- 数据  %>
```

```html
<!-- 标准语法 -->
<p>{{@ content }}</p>

<!-- 原始语法 -->
<p><%- content%></p>
```

#### 条件判断

```html
 <!-- 标准语法 --> 
{{if age > 18}}
 年龄大于18
{{else if age < 15 }}
 年龄小于15
{{else}}
 年龄不符合要求
{{/if}}

<!-- 原始语法 -->
<% if (age > 18) { %>
 年龄大于18
<% } else if (age < 15) { %>
 年龄小于15
<% } else { %>
 年龄不符合要求
<% } %>
```

#### 循环

```html
标准语法： {{each 数据}} {{/each}}
原始语法：<% for() { %> <% } %>
```

```html
 <!-- 标准语法 -->
<ul>
 {{each users}}
  <li>
   {{$value.name}}
   {{$value.age}}
   {{$value.sex}}
  </li>
 {{/each}}
</ul>

  <!-- 原始语法 -->
<ul>
 <% for (var i = 0; i < users.length; i++) { %>
  <li>
   <%=users[i].name %>
   <%=users[i].age %>
   <%=users[i].sex %>
  </li>
 <% } %>
</ul>
```

#### 子模版

使用子模板可以将网站公共区块(头部、底部)抽离到单独的文件中。

```html
标准语法： {{include '模板'}}
原始语法：<%include('模板') %>
```

```html
  <!-- 标准语法 -->
 {{include './header.art'}}

  <!-- 原始语法 -->
 <% include('./header.art') %>
```

### 模板继承

使用模板继承可以将网站HTML骨架抽离到单独的文件中，其他页面模板可以继承骨架文件。

![模板继承](https://cdn.jsdelivr.net/gh/bymori/image-PicX@main/img/osz8n1im9d-1636203959358.png)

![模板继承](https://cdn.jsdelivr.net/gh/bymori/image-PicX@main/img/3vy4j9j5qd-1636204007463.png)

```html
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <title>HTML骨架模板</title>
 {{block 'link'}} {{/block}}
</head>
<body>
 {{block 'content'}} {{/block}}
</body>
</html>
```

```html
 <!--index.art 首页模板-->
{{extend './common/layout.art'}}

{{block 'link'}}
<link rel="stylesheet" type="text/css" href="./main.css">
{{/block}}

{{block 'content'}}
<p>{{ msg }}</p>
{{/block}}
```

### 模板配置

1. 向模板中导入变量 `template.defaults.imports.变量名 = 变量值;`
2. 设置模板根目录 `template.defaults.root = 模板目录`
3. 设置模板默认后缀 `template.defaults.extname = '.art'`

```js
// 设置模板的根目录
template.defaults.root = path.join(__dirname, 'views');

// 导入模板变量
template.defaults.imports.dateFormat = dateFormat;

// 配置模板的默认后缀
template.defaults.extname = '.html';
```
